
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Elbrus Training</title>
<link rel="manifest" href="manifest.json">
<style>
body { margin:0; font-family:Arial; background:#0f172a; color:white; }
header { padding:16px; font-size:20px; font-weight:bold; text-align:center; }
.card { background:#1e293b; margin:12px; padding:12px; border-radius:12px; }
button { background:#22c55e; border:none; padding:8px 12px; border-radius:8px; color:black; font-weight:bold; }
input { width:100%; padding:6px; margin-top:6px; border-radius:6px; border:none; }
.progress { height:10px; background:#334155; border-radius:5px; margin-top:10px; }
.bar { height:10px; background:#22c55e; border-radius:5px; width:0%; }
</style>
</head>
<body>

<header>Elbrus South 2026</header>

<div class="card">
<h3>Неделя</h3>
<p id="weekProgress">0%</p>
<div class="progress"><div class="bar" id="bar"></div></div>
</div>

<div id="days"></div>

<script>
const days = ["Пн","Вт","Ср","Чт","Пт","Сб","Вс"];

function saveData() {
  localStorage.setItem("elbrusData", JSON.stringify(data));
}

function loadData() {
  return JSON.parse(localStorage.getItem("elbrusData")) || 
  days.map(()=>({done:false, avg:0, max:0, weight:0}));
}

let data = loadData();

function render() {
  let container = document.getElementById("days");
  container.innerHTML = "";
  let doneCount = 0;

  data.forEach((d,i)=>{
    if(d.done) doneCount++;

    container.innerHTML += `
    <div class="card">
      <strong>${days[i]}</strong>
      <label>Средний пульс</label>
      <input type="number" value="${d.avg}" onchange="update(${i},'avg',this.value)">
      <label>Макс пульс</label>
      <input type="number" value="${d.max}" onchange="update(${i},'max',this.value)">
      <label>Вес рюкзака (кг)</label>
      <input type="number" value="${d.weight}" onchange="update(${i},'weight',this.value)">
      <button onclick="toggle(${i})">${d.done?'Выполнено':'Отметить'}</button>
    </div>`;
  });

  let percent = Math.round(doneCount/7*100);
  document.getElementById("weekProgress").innerText = percent + "%";
  document.getElementById("bar").style.width = percent + "%";
}

function update(i,key,value){
  data[i][key] = Number(value);
  saveData();
}

function toggle(i){
  data[i].done = !data[i].done;
  saveData();
  render();
}

render();

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
</script>

</body>
</html>
