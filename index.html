<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Elbrus Training</title>
<style>
* {
  box-sizing: border-box;
}

html, body {
  margin:0;
  padding:0;
  height:100%;
  overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#0b1220;
  color:white;
}

#appContainer {
  height:100vh;
  display:flex;
  flex-direction:column;
}

header {
  flex:0 0 auto;
  padding:18px;
  text-align:center;
  font-weight:600;
  border-bottom:1px solid #1f2937;
}

.screen {
  flex:1 1 auto;
  overflow-y:auto;
  padding:16px;
  -webkit-overflow-scrolling:touch;
}

.card {
  background:#111827;
  padding:20px;
  margin-bottom:16px;
  border-radius:14px;
  border:2px solid transparent;
  transition:0.2s ease;
}

.card.done {
  border:2px solid #22c55e;
}

button {
  width:100%;
  padding:12px;
  background:#1f2937;
  border:none;
  border-radius:10px;
  color:white;
  font-size:15px;
  margin-top:12px;
}

button.done-btn {
  background:#14532d;
}

.back-btn {
  margin-bottom:14px;
  background:#374151;
}

input, textarea {
  width:100%;
  padding:14px;
  margin-top:12px;
  border-radius:10px;
  border:none;
  background:#1f2937;
  color:white;
  font-size:16px;
}

textarea {
  resize:none;
}

.exercise-img {
  width:100%;
  height:160px;
  background:#1f2937;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-bottom:16px;
}
</style>
</head>
<body>

<div id="appContainer">
  <header id="headerTitle">Неделя 1</header>
  <div id="screen" class="screen"></div>
</div>

<script>

let currentScreen = "week";
let currentDay = null;
let currentExercise = null;

let weekData = JSON.parse(localStorage.getItem("elbrusWeek1")) || {
  "Пн": [
    {
      name: "Степ-апы",
      technique: "Стопа полностью на опоре. Толчок пяткой. Колено не заваливается внутрь.",
      avg: "",
      max: "",
      comment: "",
      done: false
    },
    {
      name: "Ягодичный мост",
      technique: "Поднимай таз за счёт ягодиц. Не переразгибай поясницу.",
      avg: "",
      max: "",
      comment: "",
      done: false
    }
  ],
  "Вт": [], "Ср": [], "Чт": [], "Пт": [], "Сб": [], "Вс": []
};

function saveData() {
  localStorage.setItem("elbrusWeek1", JSON.stringify(weekData));
}

function render() {
  const screen = document.getElementById("screen");
  screen.innerHTML = "";

  if (currentScreen === "week") renderWeek(screen);
  if (currentScreen === "day") renderDay(screen);
  if (currentScreen === "exercise") renderExercise(screen);
}

function renderWeek(screen) {
  document.getElementById("headerTitle").innerText = "Неделя 1";

  Object.keys(weekData).forEach(day => {
    const card = document.createElement("div");
    card.className = "card";

    const btn = document.createElement("button");
    btn.innerText = day;
    btn.onclick = () => {
      currentDay = day;
      currentScreen = "day";
      render();
    };

    card.appendChild(btn);
    screen.appendChild(card);
  });
}

function renderDay(screen) {
  document.getElementById("headerTitle").innerText = currentDay;

  const back = document.createElement("button");
  back.className = "back-btn";
  back.innerText = "← Назад";
  back.onclick = () => {
    currentScreen = "week";
    render();
  };
  screen.appendChild(back);

  const exercises = weekData[currentDay];

  if (exercises.length === 0) {
    screen.innerHTML += "<div class='card'>День пока не заполнен</div>";
    return;
  }

  exercises.forEach((ex, index) => {
    const card = document.createElement("div");
    card.className = "card";
    if (ex.done) card.classList.add("done");

    const btn = document.createElement("button");
    btn.innerText = ex.name;
    btn.onclick = () => {
      currentExercise = index;
      currentScreen = "exercise";
      render();
    };

    card.appendChild(btn);
    screen.appendChild(card);
  });
}

function renderExercise(screen) {
  const exercise = weekData[currentDay][currentExercise];
  document.getElementById("headerTitle").innerText = exercise.name;

  const back = document.createElement("button");
  back.className = "back-btn";
  back.innerText = "← Назад";
  back.onclick = () => {
    currentScreen = "day";
    render();
  };
  screen.appendChild(back);

  const card = document.createElement("div");
  card.className = "card";
  if (exercise.done) card.classList.add("done");

  const img = document.createElement("div");
  img.className = "exercise-img";
  img.innerHTML = `
  <svg width="120" height="120">
    <rect x="40" y="70" width="40" height="10" fill="#6b7280"/>
    <line x1="60" y1="70" x2="60" y2="40" stroke="#22c55e" stroke-width="4"/>
    <circle cx="60" cy="30" r="8" fill="#22c55e"/>
  </svg>`;
  card.appendChild(img);

  const tech = document.createElement("div");
  tech.innerText = exercise.technique;
  tech.style.marginBottom = "12px";
  card.appendChild(tech);

  const avg = document.createElement("input");
  avg.type = "text";
  avg.inputMode = "numeric";
  avg.pattern = "[0-9]*";
  avg.placeholder = "Средний пульс";
  avg.value = exercise.avg;
  avg.oninput = (e) => {
    exercise.avg = e.target.value;
    saveData();
  };
  card.appendChild(avg);

  const max = document.createElement("input");
  max.type = "text";
  max.inputMode = "numeric";
  max.pattern = "[0-9]*";
  max.placeholder = "Максимальный пульс";
  max.value = exercise.max;
  max.oninput = (e) => {
    exercise.max = e.target.value;
    saveData();
  };
  card.appendChild(max);

  const comment = document.createElement("textarea");
  comment.rows = 3;
  comment.placeholder = "Комментарий";
  comment.value = exercise.comment;
  comment.oninput = (e) => {
    exercise.comment = e.target.value;
    saveData();
  };
  card.appendChild(comment);

  const doneBtn = document.createElement("button");
  doneBtn.innerText = exercise.done ? "Выполнено ✓" : "Отметить как выполнено";
  if (exercise.done) doneBtn.classList.add("done-btn");

  doneBtn.onclick = () => {
    exercise.done = !exercise.done;
    saveData();
    render();
  };

  card.appendChild(doneBtn);

  screen.appendChild(card);
}

render();

</script>

</body>
</html>
